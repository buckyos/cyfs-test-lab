<!doctype html>
<html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Mochawesome Report</title><link rel="stylesheet" href="assets\app.css"/></head><body data-raw="{&quot;stats&quot;:{&quot;suites&quot;:3,&quot;tests&quot;:1,&quot;passes&quot;:0,&quot;pending&quot;:0,&quot;failures&quot;:1,&quot;start&quot;:&quot;2022-08-26T11:50:39.697Z&quot;,&quot;end&quot;:&quot;2022-08-26T11:51:05.536Z&quot;,&quot;duration&quot;:25839,&quot;testsRegistered&quot;:1,&quot;passPercent&quot;:0,&quot;pendingPercent&quot;:0,&quot;other&quot;:1,&quot;hasOther&quot;:true,&quot;skipped&quot;:0,&quot;hasSkipped&quot;:false},&quot;results&quot;:[{&quot;uuid&quot;:&quot;2954f48e-c0e4-477e-b8af-0d0826f7cb05&quot;,&quot;title&quot;:&quot;&quot;,&quot;fullFile&quot;:&quot;&quot;,&quot;file&quot;:&quot;&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;6765402f-92e6-471d-a542-c2ffd2dda2f9&quot;,&quot;title&quot;:&quot;cyfs协议栈测试&quot;,&quot;fullFile&quot;:&quot;E:\\cyfs-test-lab\\src\\cyfs-stack-test-typescript\\TestSuite\\unittest_stack_NDN_Chunk\\testcase_runner.ts&quot;,&quot;file&quot;:&quot;\\testcase_runner.ts&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;0afdc90d-abf9-4a1d-b572-0a1d3bfc040f&quot;,&quot;title&quot;:&quot;NDN_chunk&quot;,&quot;fullFile&quot;:&quot;E:\\cyfs-test-lab\\src\\cyfs-stack-test-typescript\\TestSuite\\unittest_stack_NDN_Chunk\\testcase_runner.ts&quot;,&quot;file&quot;:&quot;\\testcase_runner.ts&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;8f5c4070-b633-4927-a3da-d6fce1179f6b&quot;,&quot;title&quot;:&quot;NDN_chunk_second_003:#chunk 大小设置为 4 Mb&quot;,&quot;fullFile&quot;:&quot;E:\\cyfs-test-lab\\src\\cyfs-stack-test-typescript\\TestSuite\\unittest_stack_NDN_Chunk\\testcase_runner.ts&quot;,&quot;file&quot;:&quot;\\testcase_runner.ts&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;NDN_chunk_second_003:#chunk 大小设置为 4 Mb\&quot;&quot;,&quot;fullTitle&quot;:&quot;cyfs协议栈测试 NDN_chunk NDN_chunk_second_003:#chunk 大小设置为 4 Mb \&quot;before all\&quot; hook in \&quot;NDN_chunk_second_003:#chunk 大小设置为 4 Mb\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:21348,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//获取测试数据\nlet tmg = new testcaseInfo_1.TestcaseManger();\nawait tmg.initMongo();\nlet res = await tmg.findRecordById(data_1.datas.testcaseList[j].id);\nassert.ok(!res.err, res.log);\nlet testcaseInfo = res.datas[0];\ninputData = JSON.parse(testcaseInfo.input_data.toString());\nexpectData = JSON.parse(testcaseInfo.expect_result.toString());\nif (data_1.datas.stack_type == common_1.StackType.Sim) {\n    //初始化ACL配置文件\n    await common_2.ZoneSimulator.getPeerId();\n    await common_2.ZoneSimulator.removeAllConfig();\n    for (let j in inputData.stackCfgList) {\n        await aclManager.getdevice(inputData.stackCfgList[j].deviceName).initAcl({ configFile: path.join(__dirname, \&quot;acl\&quot;, inputData.stackCfgList[j].ACL.configFile) });\n    }\n    //启动模拟器连接协议栈\n    await common_2.ZoneSimulator.init();\n}\nelse {\n    // runtime/ood, 开两个端口, 1对1转发到目标协议栈\n    let proxy_target_stack = cyfs.SharedCyfsStack.open(cyfs.SharedCyfsStackParam.new_with_ws_event_ports(20002, 20001).unwrap());\n    //let stack = cyfs.SharedCyfsStack.open(cyfs.SharedCyfsStackParam.new_with_ws_event_ports(19999,20000).unwrap())\n    let resp = await proxy_target_stack.wait_online(cyfs.Some(cyfs.JSBI.BigInt(10000000)));\n    console.info(JSON.stringify(resp.unwrap()));\n    await cyfs.sleep(5000);\n    let res = await proxy_target_stack.util().get_zone({ common: { flags: 0 } });\n    console.info(JSON.stringify(res.unwrap()));\n    await cyfs.sleep(1000);\n    // local stack \n    let local_ood_stack = cyfs.SharedCyfsStack.open_default();\n    let resp2 = await local_ood_stack.wait_online(cyfs.Some(cyfs.JSBI.BigInt(10000000)));\n    console.info(JSON.stringify(resp.unwrap()));\n    await cyfs.sleep(5000);\n    remote_proxy_stack = proxy_target_stack;\n    local_stack = local_ood_stack;\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e6015bf4-94ba-4660-9086-4a3e0c3f86a8&quot;,&quot;parentUUID&quot;:&quot;8f5c4070-b633-4927-a3da-d6fce1179f6b&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook for \&quot;#chunk 大小设置为 4 Mb\&quot;&quot;,&quot;fullTitle&quot;:&quot;cyfs协议栈测试 NDN_chunk NDN_chunk_second_003:#chunk 大小设置为 4 Mb \&quot;after all\&quot; hook for \&quot;#chunk 大小设置为 4 Mb\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4195,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;//数据清理\nawait handlerManager.clearAllHandler();\nawait cyfs.sleep(2 * 1000);\nawait common_2.ZoneSimulator.stopZoneSimulator();\nawait cyfs.sleep(2 * 1000);\n//清除ACL配置文件\nawait aclManager.removeAllAcl();&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;TypeError: The \&quot;path\&quot; argument must be of type string. Received undefined&quot;,&quot;estack&quot;:&quot;TypeError [ERR_INVALID_ARG_TYPE]: The \&quot;path\&quot; argument must be of type string. Received undefined\n    at new NodeError (node:internal/errors:372:5)\n    at validateString (node:internal/validators:120:11)\n    at Object.join (node:path:429:7)\n    at Acl.removeAclToml (E:\\cyfs-test-lab\\src\\cyfs-stack-test-typescript\\common\\utils\\acl_manager.ts:19:32)\n    at AclManager.removeAllAcl (E:\\cyfs-test-lab\\src\\cyfs-stack-test-typescript\\common\\utils\\acl_manager.ts:95:39)\n    at async Context.&lt;anonymous&gt; (testcase_runner.ts:83:21)&quot;},&quot;uuid&quot;:&quot;fc2c550f-dacf-48cc-a39b-609835592add&quot;,&quot;parentUUID&quot;:&quot;8f5c4070-b633-4927-a3da-d6fce1179f6b&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[{&quot;title&quot;:&quot;#chunk 大小设置为 4 Mb&quot;,&quot;fullTitle&quot;:&quot;cyfs协议栈测试 NDN_chunk NDN_chunk_second_003:#chunk 大小设置为 4 Mb #chunk 大小设置为 4 Mb&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:284,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;// 异常用例阻塞暂时跳过\nconsole.info(`开始执行测试用例：${data_1.datas.testcaseList[j].name}`);\nif (inputData.skip) {\n    assert(false, \&quot;测试用例异常，暂时标记不执行\&quot;);\n}\n//运行超时处理机制\nlet run = true;\nlet timeout = 120 * 1000;\nif (inputData.timeout) {\n    timeout = inputData.timeout;\n}\nsetTimeout(() =&gt; {\n    if (run) {\n        console.error(false, \&quot;测试用例运行超时\&quot;);\n    }\n}, timeout);\n//运行测试用例\nswitch (inputData.opt.optType) {\n    case \&quot;put_data_chunk\&quot;: {\n        await initHandlerList(inputData, data_1.datas.stack_type, remote_proxy_stack, local_stack);\n        await put_data_chunk(inputData, expectData, data_1.datas.stack_type, remote_proxy_stack, local_stack);\n        break;\n    }\n    case \&quot;get_data_chunk\&quot;: {\n        await initHandlerList(inputData, data_1.datas.stack_type, remote_proxy_stack, local_stack);\n        await get_data_chunk(inputData, expectData, data_1.datas.stack_type, remote_proxy_stack, local_stack);\n        break;\n    }\n    case \&quot;get_data_chunk_second\&quot;: {\n        await initHandlerList(inputData, data_1.datas.stack_type, remote_proxy_stack, local_stack);\n        await get_data_chunk_second(inputData, expectData, data_1.datas.stack_type, remote_proxy_stack, local_stack);\n        break;\n    }\n    case \&quot;trans_file\&quot;: {\n        await initHandlerList(inputData, data_1.datas.stack_type, remote_proxy_stack, local_stack);\n        await trans_file(inputData, expectData, data_1.datas.stack_type, remote_proxy_stack, local_stack);\n        break;\n    }\n    case \&quot;trans_file_second\&quot;: {\n        await initHandlerList(inputData, data_1.datas.stack_type, remote_proxy_stack, local_stack);\n        await trans_file_second(inputData, expectData, data_1.datas.stack_type, remote_proxy_stack, local_stack);\n        break;\n    }\n    case \&quot;trans_dir\&quot;: {\n        await initHandlerList(inputData, data_1.datas.stack_type, remote_proxy_stack, local_stack);\n        await trans_dir(inputData, expectData, data_1.datas.stack_type, remote_proxy_stack, local_stack);\n        break;\n    }\n    case \&quot;put_object\&quot;: {\n        await initHandlerList(inputData, data_1.datas.stack_type, remote_proxy_stack, local_stack);\n        await put_object(inputData, expectData, data_1.datas.stack_type, remote_proxy_stack, local_stack);\n        break;\n    }\n    case \&quot;get_object\&quot;: {\n        await initHandlerList(inputData, data_1.datas.stack_type, remote_proxy_stack, local_stack);\n        await get_object(inputData, expectData, data_1.datas.stack_type, remote_proxy_stack, local_stack);\n        break;\n    }\n    case \&quot;select_object\&quot;: {\n        await initHandlerList(inputData, data_1.datas.stack_type, remote_proxy_stack, local_stack);\n        await select_object(inputData, expectData, data_1.datas.stack_type, remote_proxy_stack, local_stack);\n        break;\n    }\n    case \&quot;delect_object\&quot;: {\n        await initHandlerList(inputData, data_1.datas.stack_type, remote_proxy_stack, local_stack);\n        await delect_object(inputData, expectData, data_1.datas.stack_type, remote_proxy_stack, local_stack);\n        break;\n    }\n    case \&quot;post_object\&quot;: {\n        await initHandlerList(inputData, data_1.datas.stack_type, remote_proxy_stack, local_stack);\n        await post_object(inputData, expectData, data_1.datas.stack_type, remote_proxy_stack, local_stack);\n        break;\n    }\n    case \&quot;sign_verify_object\&quot;: {\n        await initHandlerList(inputData, data_1.datas.stack_type, remote_proxy_stack, local_stack);\n        await sign_verify_object(inputData, expectData, data_1.datas.stack_type, remote_proxy_stack, local_stack);\n        break;\n    }\n}\nrun = false;&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;TypeError: Cannot read properties of undefined (reading &#x27;desc&#x27;)&quot;,&quot;estack&quot;:&quot;TypeError: Cannot read properties of undefined (reading &#x27;desc&#x27;)\n    at Function.transChunksByGetData (E:\\cyfs-test-lab\\src\\cyfs-stack-test-typescript\\common\\utils\\ndn.ts:17:42)\n    at get_data_chunk_second (testcase_runner.ts:250:36)\n    at processTicksAndRejections (node:internal/process/task_queues:96:5)\n    at async Context.&lt;anonymous&gt; (testcase_runner.ts:116:29)&quot;},&quot;uuid&quot;:&quot;c46c58e1-ae27-4c30-b529-5d6f04ed8c68&quot;,&quot;parentUUID&quot;:&quot;8f5c4070-b633-4927-a3da-d6fce1179f6b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[],&quot;failures&quot;:[&quot;c46c58e1-ae27-4c30-b529-5d6f04ed8c68&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:284,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:0}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:0}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:0}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:true,&quot;rootEmpty&quot;:true,&quot;_timeout&quot;:2000}],&quot;meta&quot;:{&quot;mocha&quot;:{&quot;version&quot;:&quot;9.2.2&quot;},&quot;mochawesome&quot;:{&quot;options&quot;:{&quot;quiet&quot;:false,&quot;reportFilename&quot;:&quot;mochawesome&quot;,&quot;saveHtml&quot;:true,&quot;saveJson&quot;:true,&quot;consoleReporter&quot;:&quot;spec&quot;,&quot;useInlineDiffs&quot;:false,&quot;code&quot;:true},&quot;version&quot;:&quot;6.3.1&quot;},&quot;marge&quot;:{&quot;version&quot;:&quot;5.2.0&quot;}}}" data-config="{&quot;reportFilename&quot;:&quot;mochawesome&quot;,&quot;reportDir&quot;:&quot;mochawesome-report&quot;,&quot;reportTitle&quot;:&quot;unittest_stack_NDN_Chunk&quot;,&quot;reportPageTitle&quot;:&quot;Mochawesome Report&quot;,&quot;inline&quot;:false,&quot;inlineAssets&quot;:false,&quot;cdn&quot;:false,&quot;charts&quot;:false,&quot;enableCharts&quot;:false,&quot;code&quot;:true,&quot;enableCode&quot;:true,&quot;autoOpen&quot;:false,&quot;overwrite&quot;:true,&quot;timestamp&quot;:false,&quot;ts&quot;:false,&quot;showPassed&quot;:true,&quot;showFailed&quot;:true,&quot;showPending&quot;:true,&quot;showSkipped&quot;:false,&quot;showHooks&quot;:&quot;failed&quot;,&quot;saveJson&quot;:true,&quot;saveHtml&quot;:true,&quot;dev&quot;:false,&quot;assetsDir&quot;:&quot;mochawesome-report\\assets&quot;,&quot;jsonFile&quot;:&quot;E:\\cyfs-test-lab\\src\\cyfs-stack-test-typescript\\TestSuite\\unittest_stack_NDN_Chunk\\mochawesome-report\\mochawesome.json&quot;,&quot;htmlFile&quot;:&quot;E:\\cyfs-test-lab\\src\\cyfs-stack-test-typescript\\TestSuite\\unittest_stack_NDN_Chunk\\mochawesome-report\\mochawesome.html&quot;}"><div id="report"></div><script src="assets\app.js"></script></body></html>