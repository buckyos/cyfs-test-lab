# 协议栈测试需求

 
## 测试环境

所有的用例，都要在模拟器环境和真实实验室环境下测试通过，设计跨协议栈的测试时，需要考虑到Zone内和Zone外两种情况

### 协议栈模拟器

模拟器环境：两个People，两个Zone。


Zone1：

> - 一个主OOD

> - 一个从OOD

> - 普通Device1

> - 普通Device2

 
Zone2：

> - 一个主OOD

> - 普通Device1

> - 普通Device2

 
### 实验室真实环境

实验室的真实环境一定要保证各个设备之间的联通性，不在网络和bdt问题上浪费测试时间

 
实验室的真实环境可以参照模拟器的环境搭建。如果实验室设备不够，可以减少一个普通Device

 
在测试中，普通Device的角色由cyfs-runtime担当，可以在一台机器上同时运行一个OOD和一个普通Device

 
## 测试语言

 
需要测试js和rust的版本，有些用例需要跨语言交叉测试

 
目前以ts版本优先

 
## 测试功能

 
### 基础功能

 
- 编解码框架: 对一些标准对象和核心对象的编解码测试，需要跨语言测试

- 自定义对象：自定义一个复杂对象，进行编解码测试。需要跨语言测试

- 签名和加解密：对对象的签名和验证，可以跨语言测试

 
### Meta

 
- 对Meta Client的接口测试。这种测试可以自己搭建私有链

 
### 协议栈SDK

协议栈需要测试http和websocker两种调用模式，通过CyfsStackRequestorConfig配置。两种调用模式的行为应该相同 

- NON

- NDN

  > - range协议测试，包括chunk和file

- ACL

- Handler

- Crypto：对象的签名和校验

- root state: 可以通过root state stub进行测试

  > - root state

  > - local cache

  > - 两边对应的access stub测试

- Trans

  > - 本地publish后本地下载

  > - 本地publish后远程下载

- Util

- State Storage：对root state/local cache的再封装

- Sync：主从OOD的同步

- Front：fetch 特定的url，runtime和gateway都支持

  > - 标准的o/r/l/a协议

  > - 默认协议是否正确

  > - mode字段支持

  > - format字段支持

- Event：现在只有TestEvent和RoleChangedEvent，TestEvent需要在rust协议栈端手动触发。这个测试需要rust这边做一些支持

### 协议栈SDK-TOOL
 
- 身份验证

  > - 命令激活ood/runtime

  > - 命令导出people身份文件

- decapp安装
 
  > - 默认decapp发布
  
  > - 测试用decapp发布
   
  
### 协议栈组件

- app-manager

- chunk-manager

- file-manager

- ood-daemon

- ood-installer


### 统计模块

未开发完，但是可以先设计用例

- 统计客户端：检查落地聚合数据是否正确，用特殊的统计间隔，确保落地时的统计间隔正确

- 统计查看：查看一个较长的时间段，验证展示聚合数据是否正确

- 简单的性能测试：可能要用rs实现，在一秒几百~几千次统计数据的情况下，数据是否能正确落地，时间是否正常
